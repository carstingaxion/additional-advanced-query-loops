var gpql;(()=>{"use strict";var e={d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{GPQL:()=>w,GPQLControls:()=>p,GPQLControlsInheritedQuery:()=>m});const r=window.wp.blocks,a=window.wp.i18n,o=window.React,l=window.wp.hooks,n=window.wp.blockEditor,s=window.wp.components,{Fill:u,Slot:c}=(0,s.createSlotFill)("GPQLControls"),i=({children:e})=>(0,o.createElement)(u,null,e);i.Slot=({fillProps:e})=>(0,o.createElement)(c,{fillProps:e},(e=>e.length?e:null));const p=i,{Fill:y,Slot:g}=(0,s.createSlotFill)("GPQLControlsInheritedQuery"),d=({children:e})=>(0,o.createElement)(y,null,e);d.Slot=g;const m=d,q=({attributes:e,setAttributes:t})=>{const{query:{perPage:r,offset:l=0}={}}=e;return(0,o.createElement)(s.RangeControl,{label:(0,a.__)("Events Per Page","gatherpress-query-loop"),min:1,max:50,onChange:r=>{t({query:{...e.query,perPage:r,offset:l}})},value:r})},h=({attributes:e,setAttributes:t})=>{const{query:{offset:r=0}={}}=e;return(0,o.createElement)(s.RangeControl,{label:(0,a.__)("Event Offset","gatherpress-query-loop"),min:0,max:50,value:r,onChange:r=>{t({query:{...e.query,offset:r}})}})},_=({attributes:e,setAttributes:t})=>{const{query:{date_query:{relation:r="",date_primary:l=new Date,date_secondary:n=new Date,inclusive:u=!1}={}}={}}=e;return(0,o.createElement)(o.Fragment,null,(0,o.createElement)("h2",null,(0,a.__)("Post Date Query","gatherpress-query-loop")),(0,o.createElement)(s.SelectControl,{label:(0,a.__)("Date Relationship","gatherpress-query-loop"),value:r,options:[{label:"None",value:""},{label:"Before",value:"before"},{label:"After",value:"after"},{label:"Between",value:"between"}],onChange:r=>{t({query:{...e.query,date_query:""!==r?{...e.query.date_query,relation:r}:""}})}}),""!==r&&(0,o.createElement)(o.Fragment,null,"between"===r&&(0,o.createElement)("h4",null,(0,a.__)("Start date","gatherpress-query-loop")),(0,o.createElement)(s.DatePicker,{currentDate:l,onChange:r=>{t({query:{...e.query,date_query:{...e.query.date_query,date_primary:r}}})}}),"between"===r&&(0,o.createElement)(o.Fragment,null,(0,o.createElement)("h4",null,(0,a.__)("End date","gatherpress-query-loop")),(0,o.createElement)(s.DatePicker,{currentDate:n,onChange:r=>{t({query:{...e.query,date_query:{...e.query.date_query,date_secondary:r}}})}})),(0,o.createElement)("br",null),(0,o.createElement)(s.CheckboxControl,{label:(0,a.__)("Include selected date(s)","gatherpress-query-loop"),help:(0,a.__)("Should the selected date(s) be included in your query?","gatherpress-query-loop"),checked:u,onChange:r=>{t({query:{...e.query,date_query:{...e.query.date_query,inclusive:r}}})}})))},b=({attributes:e,setAttributes:t})=>{const{query:{order:r,orderBy:l}={}}=e,n="asc"===r?(0,a.__)("Ascending Order","gatherpress-query-loop"):(0,a.__)("Descending Order","gatherpress-query-loop");return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(s.SelectControl,{label:(0,a.__)("Post Order By","gatherpress-query-loop"),value:l,help:"meta_value"===l||"meta_value_num"===l?(0,a.__)("Meta Value and Meta Value Num require that Meta Key is set in the Meta Query section.","gatherpress-query-loop"):"",options:[{label:(0,a.__)("Date","gatherpress-query-loop"),value:"date"},{label:(0,a.__)("Last Modified Date","gatherpress-query-loop"),value:"modified"},{label:(0,a.__)("Title","gatherpress-query-loop"),value:"title"},{label:(0,a.__)("Random","gatherpress-query-loop"),value:"rand"},{label:(0,a.__)("Post ID","gatherpress-query-loop"),value:"id"}],onChange:r=>{t({query:{...e.query,orderBy:r}})}}),(0,o.createElement)(s.ToggleControl,{label:n,checked:"asc"===r,onChange:()=>{t({query:{...e.query,order:"asc"===r?"desc":"asc"}})}}))},E=window.wp.data,v=({attributes:e,setAttributes:t})=>{const{query:{exclude_current:r}={}}=e,l=(0,E.useSelect)((e=>e("core/editor").getCurrentPost()),[]);return l?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(s.ToggleControl,{label:(0,a.__)("Exclude Current Event","gatherpress-query-loop"),checked:!!r,onChange:r=>{t({query:{...e.query,exclude_current:r?l.id:0}})}})):(0,o.createElement)("div",null,(0,a.__)("Loading…","gatherpress-query-loop"))},C=({attributes:e,setAttributes:t})=>{const{query:{gp_events_query:r="upcoming"}={}}=e;return(0,E.useSelect)((e=>e("core/editor").getCurrentPost()),[])?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(s.ToggleControl,{label:(0,a.__)("Upcoming or past events.","gatherpress-query-loop"),help:(0,a.sprintf)(/* translators: %s: 'upcoming' or 'past' */ /* translators: %s: 'upcoming' or 'past' */
(0,a._x)("Currently shows %s events.","'upcoming' or 'past'","gatherpress-query-loop"),r),checked:"past"===r,onChange:r=>{t({query:{...e.query,gp_events_query:r?"past":"upcoming"}})}})):(0,o.createElement)("div",null,(0,a.__)("Loading…","gatherpress-query-loop"))};(0,l.addFilter)("editor.BlockEdit","core/query",(e=>t=>{if(!(e=>{const{attributes:{namespace:t}}=e;return t&&t===w})(t))return(0,o.createElement)(e,{...t});const r=function(e=null){return"gatherpress_event"===(e||(0,E.select)("core/editor").getCurrentPostType())}(),{attributes:l}=t;return!1===l.query.inherit?(0,o.createElement)(o.Fragment,null,(0,o.createElement)(e,{...t}),(0,o.createElement)(n.InspectorControls,null,(0,o.createElement)(s.PanelBody,{title:(0,a.__)("GatherPress Query Settings","gatherpress-query-loop")},(0,o.createElement)(C,{...t}),r&&(0,o.createElement)(v,{...t}),(0,o.createElement)(q,{...t}),(0,o.createElement)(h,{...t}),(0,o.createElement)(b,{...t}),(0,o.createElement)(_,{...t}),(0,o.createElement)(p.Slot,{fillProps:{...t}})))):(0,o.createElement)(o.Fragment,null,(0,o.createElement)(e,{...t}),(0,o.createElement)(n.InspectorControls,null,(0,o.createElement)(s.PanelBody,{title:(0,a.__)("GatherPress Query Settings","gatherpress-query-loop")},(0,o.createElement)(b,{...t}),(0,o.createElement)(m.Slot,{fillProps:{...t}}))))}));const w="gatherpress-query-loop",f={namespace:w,query:{perPage:3,pages:0,offset:0,postType:"gatherpress_event",gp_events_query:"upcoming",order:"desc",orderBy:"date",inherit:!1}};(0,r.registerBlockVariation)("core/query",{name:w,title:(0,a.__)("GatherPress Query Loop","gatherpress-query-loop"),description:(0,a.__)("Create gatherpress queries","gatherpress-query-loop"),category:"gatherpress",icon:"nametag",isActive:["namespace","scope"],attributes:{...f},allowedControls:["inherit","taxQuery"],scope:["inserter","transform"],example:{attributes:{...f},innerBlocks:[{name:"core/post-template",attributes:{},innerBlocks:[{name:"gatherpress/event-date"},{name:"core/post-title"},{name:"gatherpress/venue",attributes:{mapShow:!1}}]}]}}),(0,r.registerBlockVariation)("core/query",{name:"gatherpress-query-loop-map-date",title:(0,a.__)("Map & Event-Date","gatherpress-query-loop"),description:(0,a.__)("Create gatherpress queries with Map & Date","gatherpress-query-loop"),icon:"nametag",isActive:["namespace","scope"],attributes:{...f},allowedControls:["inherit","taxQuery"],scope:["block"],innerBlocks:[["core/post-template",{},[["gatherpress/venue"],["gatherpress/event-date"]]],["core/query-pagination"],["core/query-no-results"]]}),(0,r.registerBlockVariation)("core/query",{name:"gatherpress-query-loop-date-title",title:(0,a.__)("Event-Date & Title","gatherpress-query-loop"),description:(0,a.__)("Create gatherpress queries with Event-Date & Title","gatherpress-query-loop"),icon:"nametag",isActive:["namespace","scope"],attributes:{...f},allowedControls:["inherit","taxQuery"],scope:["block"],innerBlocks:[["core/post-template",{},[["gatherpress/event-date"],["core/post-title"]]],["core/query-pagination"],["core/query-no-results"]]}),(0,r.registerBlockVariation)("core/query",{name:"gatherpress-query-loop-date-address",title:(0,a.__)("Event-Date & Address","gatherpress-query-loop"),description:(0,a.__)("Create gatherpress queries with Event-Date & Address","gatherpress-query-loop"),icon:"nametag",isActive:["namespace","scope"],attributes:{...f},allowedControls:["inherit","taxQuery"],scope:["block"],innerBlocks:[["core/post-template",{},[["gatherpress/event-date"],["gatherpress/venue",{mapShow:!1}]]],["core/query-pagination"],["core/query-no-results"]]}),gpql=t})();